"use strict";(globalThis.webpackChunk_snx_v3_liquidity=globalThis.webpackChunk_snx_v3_liquidity||[]).push([[3686],{13686:(t,e,a)=>{a.r(e),a.d(e,{WithdrawModal:()=>A,WithdrawModalUi:()=>q,default:()=>S});var s=a(11082),i=a(59176),r=a(74008),l=a(84626),n=a(70065),o=a(2784),u=a(25042),d=a(59291),c=a(1492),h=a(97721),p=a(40109),y=a(99581),b=a(28145),w=a(76885),m=a(75429),x=a(21849),C=a(77528),v=a(88383),f=a(34691),j=a(13797),g=a(89536),D=a(45071),W=a(73635),k=a(64996),$=a(52322);const q=({isDebtWithdrawal:t,amount:e,isOpen:a,onClose:n,onSubmit:o,state:d,symbol:c})=>{if(a)return d.step>1?(0,$.jsx)(x.s,{onClose:o,title:(t?"Debt":"Collateral")+" successfully Withdrawn",subline:(0,$.jsxs)($.Fragment,{children:["Your ",(0,$.jsx)("b",{children:t?"Debt":"Collateral"})," has been withdrawn, read more about it in the"," ",(0,$.jsx)(s.r,{href:"https://docs.synthetix.io/v/synthetix-v3-user-documentation",target:"_blank",color:"cyan.500",children:"Synthetix V3 Documentation"})]}),alertText:(t?"Debt":"Collateral")+" successfully Withdrawn"}):(0,$.jsxs)("div",{children:[(0,$.jsxs)(i.x,{color:"gray.50",fontSize:"20px",fontWeight:700,children:[(0,$.jsx)(m.R,{cursor:"pointer",onClick:n,mr:2}),"Manage ",t?"Debt":"Collateral"]}),(0,$.jsx)(r.i,{my:4}),(0,$.jsx)(u.P0,{step:1,title:"Withdraw",subtitle:(0,$.jsxs)(i.x,{as:"div",children:[(0,$.jsx)(D.$,{value:e}),"Â ",c," will be withdrawn"]}),status:{failed:1===d.step&&"error"===d.status,success:d.step>1,loading:1===d.step&&"pending"===d.status}}),(0,$.jsx)(l.z,{isDisabled:"pending"===d.status,onClick:o,width:"100%",mt:"6","data-testid":"withdraw confirm button",children:(()=>{switch(!0){case"error"===d.status:return"Retry";case"pending"===d.status:return"Processing...";case d.step>1:return"Done";default:return"Execute Transaction"}})()})]})};function A({liquidityPosition:t,onClose:e,isOpen:a,isDebtWithdrawal:s=!1}){const[i,r]=(0,o.useState)({step:1,status:"idle"}),{withdrawAmount:l,setWithdrawAmount:u}=(0,o.useContext)(j.n),m=(0,g.UO)(),{data:x}=(0,k.t)(m.collateralSymbol),D=(0,n.p)({isClosable:!0,duration:9e3}),{network:A}=(0,w.LN)(),S=(0,b.useQueryClient)(),{data:I}=(0,p.a)(),Q=(0,h.o)(I),T=t?.accountId,{data:_}=(0,W.p)(),{data:P}=(0,c.jZ)(T,_?.address),{mutation:K}=(0,d.Q)({amount:l,accountId:T,collateralTypeAddress:s?_.address:t?.accountCollateral.tokenAddress}),{mutation:U}=(0,f.p)({accountId:T,sUSDCCollateral:t?.accountCollateral.availableCollateral||v.GH,snxUSDCollateral:P?.availableCollateral||v.GH,amountToWithdraw:l}),E=(0,o.useCallback)((async()=>{try{1===i.step?(r({step:1,status:"pending"}),(0,C.Yz)(A?.id,A?.preset)?await U.mutateAsync():await K.mutateAsync(),r({step:2,status:"success"}),S.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"LiquidityPosition",{accountId:T}]}),S.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"AccountSpecificCollateral",{accountId:T}]}),S.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"LiquidityPositions",{accountId:T}]}),S.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"AccountCollateralUnlockDate",{accountId:T}]}),S.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"TokenBalance"]}),u(v.GH)):e()}catch(t){r((t=>({...t,status:"error"})));const e=Q(t);throw e&&console.error(new Error(e.name),e),D.closeAll(),D({title:"Withdraw failed",description:e?(0,$.jsx)(y.M,{contractError:e}):"Please try again.",status:"error",variant:"left-accent"}),Error("Withdraw failed",{cause:t})}}),[T,Q,A?.id,A?.preset,e,S,u,D,i.step,U,K]);return(0,$.jsx)(q,{amount:l,isOpen:a,onClose:e,symbol:s?_.symbol:x?.symbol,state:i,onSubmit:E,isDebtWithdrawal:s})}const S=A}}]);
//# sourceMappingURL=3686.49a93a93.js.map