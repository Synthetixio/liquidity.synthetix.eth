"use strict";(globalThis.webpackChunk_snx_v3_liquidity=globalThis.webpackChunk_snx_v3_liquidity||[]).push([[3686],{13686:(t,e,a)=>{a.r(e),a.d(e,{WithdrawModal:()=>A,WithdrawModalUi:()=>q,default:()=>$});var s=a(11082),i=a(59176),r=a(74008),l=a(84626),n=a(70065),o=a(2784),u=a(25042),d=a(59291),c=a(1492),h=a(97721),p=a(40109),y=a(99581),b=a(28145),w=a(76885),m=a(75429),x=a(21849),C=a(77528),f=a(88383),j=a(34691),g=a(13797),v=a(89536),W=a(45071),D=a(73635),k=a(64996),S=a(52322);const q=({isDebtWithdrawal:t,amount:e,isOpen:a,onClose:n,onSubmit:o,state:d,symbol:c})=>{if(a)return d.step>1?(0,S.jsx)(x.s,{onClose:o,title:(t?"Debt":"Collateral")+" successfully Withdrawn",subline:(0,S.jsxs)(S.Fragment,{children:["Your ",(0,S.jsx)("b",{children:t?"Debt":"Collateral"})," has been withdrawn, read more about it in the"," ",(0,S.jsx)(s.r,{href:"https://docs.synthetix.io/v/synthetix-v3-user-documentation",target:"_blank",color:"cyan.500",children:"Synthetix V3 Documentation"})]}),alertText:(t?"Debt":"Collateral")+" successfully Withdrawn"}):(0,S.jsxs)("div",{children:[(0,S.jsxs)(i.x,{color:"gray.50",fontSize:"20px",fontWeight:700,children:[(0,S.jsx)(m.R,{cursor:"pointer",onClick:n,mr:2}),"Manage ",t?"Debt":"Collateral"]}),(0,S.jsx)(r.i,{my:4}),(0,S.jsx)(u.P0,{step:1,title:"Withdraw",subtitle:(0,S.jsxs)(i.x,{as:"div",children:[(0,S.jsx)(W.$,{value:e}),"Â ",c," will be withdrawn"]}),status:{failed:1===d.step&&"error"===d.status,success:d.step>1,loading:1===d.step&&"pending"===d.status}}),(0,S.jsx)(l.z,{isDisabled:"pending"===d.status,onClick:o,width:"100%",mt:"6","data-testid":"withdraw confirm button",children:(()=>{switch(!0){case"error"===d.status:return"Retry";case"pending"===d.status:return"Processing...";case d.step>1:return"Done";default:return"Execute Transaction"}})()})]})};function A({liquidityPosition:t,onClose:e,isOpen:a,isDebtWithdrawal:s=!1}){const[i,r]=(0,o.useState)({step:1,status:"idle"}),{withdrawAmount:l,setWithdrawAmount:u}=(0,o.useContext)(g.n),m=(0,v.UO)(),{data:x}=(0,k.t)(m.collateralSymbol),W=(0,n.p)({isClosable:!0,duration:9e3}),{network:A}=(0,w.LN)(),$=(0,b.useQueryClient)(),{data:_}=(0,p.a)(),I=(0,h.o)(_),P=t?.accountId,{data:T}=(0,D.p)(),{data:Q}=(0,c.jZ)(P,T?.address),{mutation:E}=(0,d.Q)({amount:l,accountId:P,collateralTypeAddress:s?T.address:t?.accountCollateral.tokenAddress}),{mutation:M}=(0,j.p)({accountId:P,sUSDCCollateral:t?.accountCollateral.availableCollateral||f.GH,snxUSDCollateral:Q?.availableCollateral||f.GH,amountToWithdraw:l}),O=(0,o.useCallback)((async()=>{try{1===i.step?(r({step:1,status:"pending"}),(0,C.Yz)(A?.id,A?.preset)?await M.mutateAsync():await E.mutateAsync(),r({step:2,status:"success"}),$.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"LiquidityPosition",{accountId:P}]}),$.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"AccountSpecificCollateral",{accountId:P}]}),$.invalidateQueries({queryKey:[`${A?.id}-${A?.preset}`,"LiquidityPositions",{accountId:P}]}),u(f.GH)):e()}catch(t){r((t=>({...t,status:"error"})));const e=I(t);throw e&&console.error(new Error(e.name),e),W.closeAll(),W({title:"Withdraw failed",description:e?(0,S.jsx)(y.M,{contractError:e}):"Please try again.",status:"error",variant:"left-accent"}),Error("Withdraw failed",{cause:t})}}),[P,I,A?.id,A?.preset,e,$,u,W,i.step,M,E]);return(0,S.jsx)(q,{amount:l,isOpen:a,onClose:e,symbol:s?T.symbol:x?.symbol,state:i,onSubmit:O,isDebtWithdrawal:s})}const $=A}}]);
//# sourceMappingURL=3686.55318c45.js.map